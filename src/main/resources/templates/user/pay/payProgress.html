<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        table {
            width: 50%; /* 테이블 너비를 50%로 설정 */
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        th, td {
            border: 1px solid #ccc;
            padding: 10px;
            text-align: left;
            font-size: 14px; /* 글씨 크기를 작게 설정 */
        }
        th {
            background-color: #f2f2f2;
        }
        input[type="text"], select {
            width: 100%; /* 입력 필드의 너비를 100%로 설정 */
            padding: 8px;
            margin: 4px 0;
            box-sizing: border-box;
        }
        hr {
            border: none;
            border-top: 1px solid #ccc;
            margin: 10px 0; /* hr 여백 조정 */
        }
        button {
            padding: 10px 15px;
            font-size: 16px; /* 버튼 크기를 조정 */
            cursor: pointer; /* 마우스 커서 변경 */
        }
        .section-title {
            font-weight: bold;
            font-size: 16px; /* 제목 크기 조정 */
            margin: 10px 0;
        }

        /* 은행과 카드 선택 테이블 숨김 처리 */
        .hidden {
            display: none;
        }
    </style>

</head>
<body>
<form th:action="@{/user/pay/receipt}" method="post">
<div class="section-title">주문자 정보</div>
    <input type="hidden" name="memberCode" th:value="${payProgressUser.memberCode}"/>
    <input type="hidden" id="toDay" name="payDate" value=""/>
    <input type="hidden" name="payTotalCnt" value="1"/>
    <input type="hidden" name="payDetailCnt" value="1"/>
    <input type="hidden" name="payDetailPrice" th:value="${payProgress.productPrice}"/>
    <input type="hidden" name="payDeliverStatus" value="배송전"/>
    <input type="hidden" name="payRefundYn" value="Y"/>
    <input type="hidden" name="payDeleteYn" value="N"/>
    <input type="hidden" name="reviewYn" value="N"/>
    <input type="hidden" name="productCode" th:value="${payProgress.productCode}"/>
    <input type="hidden" name="productName" th:value="${payProgress.productName}"/>
<table>
    <tbody>
    <tr>
        <th>이 름</th>
        <td><input type="text" placeholder="이름 입력" th:value="${payProgressUser.memberName}"/></td>
    </tr>
    <tr>
        <th>이메일</th>
        <td><input type="text" placeholder="이메일 입력" th:value="${payProgressUser.memberEmail}"/></td>
    </tr>
    <tr>
        <th>전화번호</th>
        <td><input type="text" placeholder="전화번호 입력" th:value="${payProgressUser.memberPhone}"/></td>
    </tr>
    </tbody>
</table>

<div class="section-title">배송지 정보</div>
<table>
    <tbody>
    <tr>
        <th>받는분 성함 </th>
        <td><input type="text" name="payReceiver" placeholder="받는분 성함 입력" required/></td>
    </tr>
    <tr>
        <th>전화번호 </th>
        <td><input type="text" name="payDeliverPhone" placeholder="전화번호 입력 (숫자만 입력해주세요)" pattern="^[0-9]+$" title="숫자만 입력해주세요." required/></td>
    </tr>
    <tr>
        <th>배송주소 </th>
        <td><input type="text" name="payAddress" placeholder="주소 입력" required/></td>
    </tr>
<!--    <tr>-->
<!--        <td colspan="2"><input type="text"  placeholder="상세주소 입력" required/></td>-->
<!--    </tr>-->
    <tr>
        <th>배송요청사항 </th>
        <td>
            <select name="deliveryRQ">
                <option value="dRQ0">배송요청사항을 선택하세요</option>
                <option value="dRQ1">집앞에 던져놔주세요</option>
                <option value="dRQ2">문앞을 막아놔주세요</option>
                <option value="dRQ3">창문으로 집어 던져주세요</option>
                <option value="dRQ4">계단인데 7층으로 옮겨주세요</option>
            </select>
        </td>
    </tr>
    </tbody>
</table>

<div class="section-title">결제수단</div>
<table>
    <tbody>
    <tr>
        <th>결제선택</th>
        <td><input type="radio" name="payPG" class="bank" id="bankRadio">은행</td>
        <td><input type="radio" name="payPG" class="card" id="cardRadio">카드</td>
    </tr>
    </tbody>
</table>
<table id="bankTable" class="hidden">
    <tbody>
    <tr>
        <th>은행 </th>
        <td>
            <select name="bankCode">
                <option value="1" selected >은행을 선택하세요</option>
                <option value="2">우리</option>
                <option value="3">신한</option>
                <option value="4">국민</option>
                <option value="5">기업</option>
                <option value="6">농협</option>
                <option value="7">하나</option>
                <option value="8">SC제일</option>
                <option value="9">우체국</option>
                <option value="10">케이뱅크</option>
            </select>
        </td>
    </tr>
    <tr>
        <th>계좌번호 </th>
        <td><input name="payAccountNumber" type="text" placeholder="계좌번호 입력" pattern="^[0-9]+$" title="숫자만 입력해주세요." value=""/></td>
    </tr>
    </tbody>
</table>

<!-- 카드 관련 테이블 -->
<table id="cardTable" class="hidden">
    <tbody>
    <tr>
        <th>카드사 </th>
        <td>
            <select name="cardCompanyCode" >
            <option value="1" selected>카드사를 선택하세요</option>
            <option value="2">BC</option>
            <option value="3">우리</option>
            <option value="4">삼성</option>
            <option value="5">롯데</option>
            <option value="6">신한</option>
            <option value="7">KB국민</option>
            <option value="8">NH농협</option>
            <option value="9">카카오뱅크</option>
            <option value="10">씨티</option>
            <option value="11">하나</option>
        </select>
        </td>
    </tr>
    <tr>
        <th>카드번호 </th>
        <td><input type="text" name="payCardNumber" placeholder="카드번호 입력" pattern="^[0-9]{16}$" title="카드번호는 16자리 숫자여야 합니다." value=""/></td>
    </tr>
    </tbody>
</table>

<div class="section-title">결제 정보</div>
<table>
    <tbody>
    <tr>
        <th>결제하실 금액 </th>
        <td><input type="text" name="payTotalPrice" placeholder="결제 금액 입력" th:value="${payProgress.productPrice}" required/></td>
    </tr>
    <tr>
        <th>총 금액 </th>
        <td><input type="text" th:value="${payProgress.productPrice}" disabled/></td>
    </tr>
    </tbody>
</table>
<button type="submit">결제하기</button>
</form>

<script>
    // 은행과 카드 테이블을 숨기거나 표시하는 함수
    document.getElementById('bankRadio').addEventListener('click', function () {
        document.getElementById('bankTable').classList.remove('hidden');
        document.getElementById('cardTable').classList.add('hidden');
    });

    document.getElementById('cardRadio').addEventListener('click', function () {
        document.getElementById('cardTable').classList.remove('hidden');
        document.getElementById('bankTable').classList.add('hidden');
    });


        // 현재 날짜를 yyyy-MM-dd 형식으로 가져오는 함수
        const toDay = new Date().toISOString().split('T')[0];

        // hidden input 필드에 현재 날짜 설정
        document.getElementById('toDay').value = toDay;
        console.log(toDay);

        document.querySelector('form').addEventListener('submit', function (ev) {
            // 결제수단 선택 확인
            const bankSelected = document.getElementById('bankRadio').checked;
            const cardSelected = document.getElementById('cardRadio').checked;

            if (!bankSelected && !cardSelected) {
                alert('결제수단을 선택하세요.');
                ev.preventDefault(); // 폼 제출 방지
                return;
            }

            // 결제수단이 은행인 경우
            if (bankSelected) {
                const bankCode = document.querySelector('select[name="bankCode"]').value;
                const accountNumber = document.querySelector('input[name="payAccountNumber"]').value;

                if (bankCode === "1") {
                    alert('은행을 선택하세요.');
                    ev.preventDefault();
                    return;
                }

                if (!accountNumber) {
                    alert('계좌번호를 입력하세요.');
                    ev.preventDefault();
                    return;
                }
            }

            // 결제수단이 카드인 경우
            if (cardSelected) {
                const cardCompanyCode = document.querySelector('select[name="cardCompanyCode"]').value;
                const cardNumber = document.querySelector('input[name="payCardNumber"]').value;

                if (cardCompanyCode === "1") {
                    alert('카드사를 선택하세요.');
                    ev.preventDefault();
                    return;
                }

                if (!cardNumber) {
                    alert('카드번호를 입력하세요.');
                    ev.preventDefault();
                    return;
                }
            }
        });

</script>
</body>
</html>
